namespace :fun do
  desc "Animated Man Walking"
  task migrate: :environment do


    {red: 31, green: 32, yellow: 33, purple: 34, pink: 35, blue: 36, white: 37, black: 30}.each { |color, key| define_method("#{color}") { |text| "\e[#{key}m#{text}\e[0m" }}

    def clear_screen!
      print "\e[2J" # clears the screen
    end

    def move_to_home!
      print "\e[H" # moves the cursor back to the upper left
    end

    # use http://www.glassgiant.com/ascii/ to convert images to ascii

    walk1 = <<-WALK_1
    ........................................
    ........................................
    ...............,........................
    .............I  77    ..................
    ............7 7 I7   7  ................
    ..........,    7        I...............
    ...........7   I         ...............
    ...........    I     7777...............
    ..........,7   7        7,..............
    ...........=   7        ,...............
    ............,   7     ?,................
    ...............,I I+....................
    ...............,777,....................
    ..............~: 7I,....................
    ...........IIIII    ....................
    ........,IIIIII+     ......~ ,..........
    ......,IIIII~,.:      ,..: 7+?..........
    .......II+.....,  ,7   ...7   +,........
    .......II?.....=    ~   ,I   ~,.........
    ......:II?.....7     +     .............
    ......=II?....,7      ..  ,.............
    .....,=I.:,..,I7      ..,...............
    ....,++I+I=..?  77    ..................
    .....,:I=II?=7      7?..................
    ........,,+~,       I,..................
    ............,       ....................
    ............~7  77.?....................
    ...........:  ?..?III...................
    ...........  I,...:III,.................
    .........    :......II?,................
    ....,.7  7 7:.......=II?................
    ...~  7  7?,.........III,...............
    ...:  7I.............:II=,IIIII.........
    ....   :.............,IIIIIII...........
    ...,    .............,IIII~.............
    ....I     :............,................
    ......?II?~,............................
    ........................................
    ........................................
    WALK_1

    walk2 = <<-WALK_2
    ........................................
    ........................................
    ........................................
    ........................................
    ..............,:?II~....................
    .............7  I     ?,................
    ...........?    7       ,...............
    ..........,    7        =...............
    ..........,7   7         ,..............
    ..........,7   7         ,..............
    ..........,    I        :...............
    ...........,   7       7................
    .............I7 I7   7..................
    ................77......................
    ...............,7 I.....................
    ...........,,II?   .....................
    ........,?IIIIII    I,........ =........
    ......:IIIII?.,=      .....,  :,........
    ......II?......,  7I   :....I  I~,......
    .....,II+......:    :7  ..+   7I.,......
    ......II=......I     +7  7  7...........
    ....+:II:......7      ..  I.............
    ..,I:,?7I,.....       ..................
    ...I?II?.,.... I7     ,.................
    .....IIII,...    7I777..................
    ........,...,7       ...................
    ............,7  7   ....................
    .............7     .I...................
    .............:  ~..III,.................
    ......?:.,...+  ,...III,................
    ......=7 7 77   .....III,...............
    .......  7 7    ,....+II................
    .......= 7~...,,....,III................
    ........I  ,.......,III.................
    .........  =.......IIIIIII?,............
    ..........~......,.,:~~~~,.,............
    ........................................
    ........................................
    ........................................
    WALK_2

    walk3 = <<-WALK_3
    ........................................
    ........................................
    ..............,,~++,,...................
    .............   I    7,.................
    ...........I  77 7   7  ................
    ...........7   7        ~...............
    ..........=7777I7777    7,..............
    ..........~    7        I,..............
    ..........,7   I        ,...............
    ...........+   I       7................
    ............,7  7     ..................
    ................77,.....................
    ................ 7+.....................
    ...............7 7 ,....................
    ................    ,...................
    ...............7  77=...................
    ..............?  =I  ...................
    .............=  77   7..................
    ............,  7=     ,.................
    .............7 .      ..................
    .............I  .     ,.................
    ..............7  ~    ..................
    .............7,  7:.7+..................
    .............  7 =I I...................
    .............  .    7,..................
    .............7 II :+7 ..................
    .............,I..,:7....................
    .............,II,7  7,..................
    ...........,  7=,,:   ..................
    ............,         ..................
    ............,7  7 ?:,...................
    ............,,  7.......................
    ...........,II. 7,......................
    ...........III..7,......................
    .........:IIIIIII?......................
    ........,.,:~~~:,.,.....................
    ........................................
    ........................................
    ........................................
    WALK_3

    walk4 = <<-WALK_4
    ...............,,,,,....................
    .............?  77    ,.................
    ...........,   77      I................
    ..........,    I     7 7,...............
    ..........:   77 7   7 7 ,..............
    ..........:7   7       77,..............
    ...........7   I        ,...............
    ...........7   I       7,...............
    .............  77     +,................
    ..............,+I 7I.,..................
    ................I  ,....................
    .................77,....................
    .............,+  7 7....................
    ............:77  7  ....................
    ...........     I7   ...................
    .........~ 7 7=.     ?..................
    ........:   ...:      ..................
    ........,  ....I      ....,:?II.........
    .........  ?...       ,,,,I.III.........
    .........  7,.=7      .III.~II~.........
    .........7 7:: 7I7    .,+.,++~..........
    .........? ,,~I     7+.....,............
    .........  7 I+7    I...................
    ........:7I~= .     +,..................
    .........,.,:I:       7.................
    ............III.....7   =,..............
    ..........,III.....,:77  7..............
    ..........III,..,       ,...............
    ........:III......   ~..................
    ......,?III........~   7................
    ......IIII,.........,?7 :...............
    ....,IIII..............+7,..............
    ...,IIII,...............................
    ....IIII~...............................
    .....IIIIII?............................
    ......::::,.............................
    ........................................
    ........................................
    ........................................
    WALK_4

    walk5 = <<-WALK_5
    ........................................
    ........................................
    ................,..,....................
    .............=   7   7..................
    ............  7 77   7  ................
    ..........,    7        +...............
    ...........7   7         ...............
    ..........,    I   777777,..............
    ..........,7   7        7,..............
    ...........?   7        ,...............
    .............7  7     I.................
    ..............,~I 77.,..................
    ..............., 7I.....................
    ..............?7777,....................
    ..........,I7      7,.......II..........
    .........? 7   7    ,.....,III+.........
    ......,    7~,.+    7~?,..?++?I.........
    .......  :.....=     ~II..=,,?~+........
    ......,  ,.....?      IIIIII+.,,........
    ......=  ,.....       ,.III.............
    ......I7 ,.....       ..................
    ......  ,~,..,77      ,.................
    ....., 7 7 ..7 777    ..................
    .....:77++:..       7~..................
    .....,::, ?..       ?...................
    .............       ....................
    ..............  7 7,....................
    ...........,III:    ,...................
    ...........III,..I   =..................
    .......,IIIII:....,   ,.................
    ...,IIIIIIII.......,  7,................
    ...,IIIII?..........7   ................
    ...,III.............,77 ....,,,.........
    ....IIII.............7   ?    ?.........
    ....=IIIII...........:      7,..........
    ....,.:::,,..........,    =,............
    .....................,:,................
    ........................................
    ........................................
    WALK_5

    walk6 = <<-WALK_6
    ........................................
    ........................................
    ........................................
    ........................................
    ........................................
    ..............7 7   7~..................
    ............    7     7,................
    ...........7   7        ,...............
    ..........,7   I        I...............
    ..........~I7777777IIII77,..............
    ..........,    I        ?...............
    ...........    7        ,...............
    ...........,? 77 7   7 .................
    .............,: 77  ?...................
    ...............,  ~.....................
    ............,.I77 I,..........,.........
    .........,~        I+,......III.........
    ........77 7  77    .I+,..~?=I:=........
    ......7   ?,...?     ,II,,..??I:........
    ......7 ,......?     ?IIIIII+?+I,.......
    ....,  7.......7      .+IIII~,..........
    ....I  .......,       ,...,.............
    ..., 7:,......:       ,.................
    ..,7    ...... 7      ,.................
    ..77777......7  777I7?..................
    ....~+ ......       7,..................
    ............,7  7   ,...................
    .............     7~....................
    .............~I.    ~...................
    ......,7+,.,,,II,=   7..................
    .......+IIIIIIII,..   7,................
    ........IIIIIIII...~   ~................
    ........=II.........   ,................
    .........II+.......I  ~.................
    ..........,I,.....,   ,.................
    ...........,......       I,.............
    ................,77 7  777I,............
    ........................................
    ........................................
    WALK_6

    walk7 = <<-WALK_7
    ........................................
    ........................................
    ...............I7777:...................
    .............   I    77.................
    ...........7  7777   7 7,...............
    ...........7   I        7,..............
    ..........,I777I77IIII77 ,..............
    ...........    7        7,..............
    ...........    I        ,...............
    ............   7       I................
    .............,7 I    7,.................
    ...............,  ~,....................
    ...............,I7I.....................
    ...............7 7 :....................
    ..............,     ....................
    ..............,   + =...................
    ..............,  =7  ...................
    ..............I  ~    ..................
    .............,  ?7    ,.................
    .............:  ,     ..................
    .............7 I?     ..................
    ..............  =7    ,.................
    ............. : 7~III7..................
    ............, ,7 ?I  ...................
    ............,  7  :+....................
    .............  . 77 +...................
    .............~ ~7   7...................
    .............? II:7. ?..................
    ............=7  .?=I?I..................
    ............,   .IIIII,.................
    ............,   ,=IIII..................
    .............  I+,..,,..................
    ...........,7  ,II,.....................
    ...........~   ,.I:.....................
    ...........   7.........................
    ..........+      7.,....................
    .........+7777 7 77+,...................
    ........................................
    ........................................
    WALK_7

    walk8 = <<-WALK_8
    ........................................
    .............~7 I7  7+..................
    ............7  77      ,................
    ..........,    I     7 7................
    ..........+   77 7   7 7I...............
    ..........?    7     77I?...............
    ..........,7   7        ,...............
    ...........7   7        ,...............
    ...........,I  7      I,................
    .............,,777 7=,..................
    ................  ~.....................
    ...............?  :.....................
    ...............  7 I....................
    .............II7 7  ,...................
    ............IIII7~  +...................
    ...........IIIII ,  7...................
    .........,II?..7 +7  ,..................
    ..........?II..   ~  ,.....~=,..........
    ..........~II..   ,     ~.7 ? 7,........
    ...........II.I7   7.:      77:.........
    ...........II7 77     ..,.+7 =..........
    .........,II.      77...................
    .........III:       ,...................
    .........~II,      7?=..................
    ...........,I     .IIII:................
    ...........~  I......+III...............
    .........., 77,....,.?IIII..............
    .........,7  ....,IIIIII~...............
    .........7  I......+III,................
    ........+  7,.......~III................
    .......+ 7 ,..........=II...............
    ......~  7I............,,:..............
    ......77  ,.............................
    ....~    ,..............................
    ....I   I,..............................
    ....,I      7...........................
    ......I7 7777I,.........................
    ........................................
    ........................................
    WALK_8

    walk9 = <<-WALK_9
    ........................................
    ........................................
    ...................,....................
    .............   7    7,.................
    ...........7  7I 7   7 :................
    ..........~7   7        ................
    ........., 7   7        :...............
    .........,    77     77I,...............
    ..........?7            ................
    ...........7   7       ?................
    ............:7 7      ..................
    ...............+77?:,...................
    ...............~ 7......................
    ............,~=7 7......................
    .........,~III,     ....................
    ........:IIIII~     +....., I,..........
    ......=IIII+...      I...7 ~~,..........
    ......?II,.....  ?=   ,.,+   +7.........
    ......III,.....    ~7  +:   I...........
    ......III,.....     7,    ?.............
    .....,?II.....+       .7 ~..............
    ......?~::,..,7       ..................
    ....:I+I+?:,,  77    :..................
    .....,II+II:,       7,..................
    .........~?:7       ....................
    ............~     7:....................
    ............77  7~+.....................
    ...........7  ,..III....................
    .........,7  .....III:..................
    .......,+   ?.....,III..................
    .....~ 7 7 I,......,III.................
    ...   7  7..........?II+................
    ...7   ,.............III.+IIII,.........
    ..,   I,.............?IIIIII+,..........
    ...=   ~.............:IIII..............
    ...,     I,...........,,................
    .....=III~..............................
    ........................................
    ........................................
    WALK_9

    cycle = [walk1, walk2, walk3, walk4, walk5, walk6, walk7, walk8, walk9]

    # Here's the actual runner

    5.times do
      cycle.each do |image| 
        clear_screen!
        move_to_home!
        print image
        sleep(0.2)
      end
    end


    clear_screen!
    move_to_home!
    puts
    puts
    puts
    puts
    puts red("That was fun, now for real work")
    puts
    sleep(1.5)
    puts "Give me a second to get this running..."
    sleep(1.5)
    puts yellow("Migrating...")
    puts
    Rake::Task["db:migrate"].invoke
    puts
    puts
    puts purple("I'm done.")
    puts 
    sleep(1.2)
    puts blue("We want to thank you.")
    puts blue("We know that you have a choice of migrating")
    puts blue("in a variety of different ways. So, Thank you")
    puts blue("again for migrating the fun way.")
    puts
    puts
    ` say We want to thank you.`
    ` say We know that you have a choice of migrating in a variety of different ways. So`
    ` say Thank you again for migrating the fun way.`

  end

end
